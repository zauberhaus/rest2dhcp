version: "2"
services:
  dhcpd:
    image: dhcpd
    build: 
      context: .
      dockerfile: ./Dockerfile.dhcpd
    networks:
      - dhcp      

  dnsmasq:
    image: dnsmasq
    build: 
      context: .
      dockerfile: ./Dockerfile.dnsmasq
    cap_add:
      - NET_ADMIN      
    networks:
      - dhcp      

  rest2dhcp:
    image: rest2dhcp
    build: 
      context: ..
      dockerfile: ./Dockerfile.alpine
    environment:
      - VERBOSE=true
      - DHCP_SERVER=dnsmasq
      - MODE=udp
    ports:
      - 8080:8080
    links:
      - dhcpd
      - dnsmasq  
    depends_on:
      - dnsmasq        
    networks:
      - dhcp      
      
networks:
  dhcp:     
    driver: bridge
    ipam:
      driver: default
      config:
        - subnet: 172.100.0.0/24
          gateway: 172.100.0.1
